<section class="characters-card" *ngIf="character">
    <div class="card">
        <mat-card [ngStyle]="{ background: bgColor1 }">
            <span
                class="card__type"
                [ngStyle]="{ background: bgColor2 }"
                [ngSwitch]="character?.charType"
            >
                <span *ngSwitchCase="'MAIN'">{{
                    'enum.charType.MAIN' | translate
                }}</span>
                <span *ngSwitchCase="'SIDE'">{{
                    'enum.charType.SIDE' | translate
                }}</span>
                <span *ngSwitchCase="'BACKGROUND'">{{
                    'enum.charType.BACKGROUND' | translate
                }}</span>
            </span>
            <mat-card-header>
                <span class="card__name">
                    <app-icon
                        *ngIf="character.gender"
                        [icon]="character.gender | lowercase"
                        [color]="character.gender | genderIconColor"
                        [size]="'0.7'"
                    >
                    </app-icon>
                    <span class="name">
                        {{ character.charName }} {{ character.charSurname }}
                        <span
                            [ngStyle]="{ color: character.colors?.themeColor1 }"
                            class="name--pseudonim"
                        >
                            {{ character.pseudonim }}</span
                        >
                    </span>
                </span>
            </mat-card-header>
            <ng-container *ngIf="character.imagesList.length > 0">
                <img
                    *ngFor="let image of character.imagesList; index as i"
                    [src]="
                        'data:image/' +
                            image?.extension +
                            ';base64, ' +
                            image.image | sanitizer
                    "
                    class="profile-pic__image profile-pic__image--inactive"
                    [ngClass]="{
                        'profile-pic__image--active': i === currentImageIndex
                    }"
                />
                <div>
                    <button
                        class="profile-pic__button"
                        [ngStyle]="{ background: bgColor2 }"
                        matRipple
                        *ngFor="let image of character.imagesList; index as i"
                        (click)="setImage(i)"
                    >
                        {{ image.name | filenameModifier }}
                    </button>
                </div>
            </ng-container>
            <div
                class="card__profile-pic--empty"
                *ngIf="character.imagesList.length === 0"
            >
                {{ 'CHARACTER_CARD.NO_PHOTOS' | translate }}.
            </div>
            <mat-card
                class="card__info info"
                [ngStyle]="{ background: bgColor2 }"
            >
                <div class="card-info nationality" *ngIf="flagURL">
                    <span class="info__desc">
                        üèÅ {{ 'CHARACTER_CARD.NATIONALITY' | translate }}
                    </span>
                    <img class="info__data flag" [src]="flagURL" />
                </div>

                <div class="card-info" *ngIf="character.birthday">
                    <span class="info__desc">
                        üéÇ {{ 'CHARACTER_CARD.BIRTHDAY' | translate }}
                    </span>
                    <span class="info__data"
                        >{{ character.birthday | date: 'dd/MM/yyyy' }}
                    </span>
                </div>

                <ng-container *ngIf="character.death">
                    <div>
                        <span class="info__desc">
                            üíÄ {{ 'CHARACTER_CARD.DEATH' | translate }}
                        </span>
                        <span class="info__data info__data--death">
                            {{ character.death | date: 'dd/MM/yyyy' }}
                            <span *ngIf="character.deathReason">
                                ({{ character.deathReason }})
                            </span>
                        </span>
                    </div>
                </ng-container>

                <div class="card-info" *ngIf="character.occupation">
                    <span class="info__desc">
                        üíº {{ 'CHARACTER_CARD.PROFESSION' | translate }}
                    </span>
                    <span class="info__data">{{ character.occupation }}</span>
                </div>

                <ng-container *ngIf="character.colors">
                    <div class="info__color color">
                        <mat-divider></mat-divider>
                        <div class="color__container">
                            <span class="color__icon">
                                <app-icon
                                    [icon]="'clothing'"
                                    [color]="'white'"
                                ></app-icon>
                            </span>
                            <div
                                class="color__item"
                                [ngStyle]="{
                                    background: character.colors.themeColor1
                                }"
                            ></div>
                            <div
                                class="color__item"
                                [ngStyle]="{
                                    background: character.colors.themeColor2
                                }"
                            ></div>
                            <div
                                class="color__item"
                                [ngStyle]="{
                                    background: character.colors.themeColor3
                                }"
                            ></div>
                        </div>
                        <div class="color__container">
                            <span class="color__icon">
                                <app-icon
                                    [icon]="'eye'"
                                    [color]="'white'"
                                ></app-icon>
                            </span>

                            <div
                                class="color__item color__item--eye"
                                [ngStyle]="
                                    getLinearGradientForEyeColor(
                                        character.colors
                                    )
                                "
                            ></div>
                        </div>
                        <div class="color__container">
                            <span class="color__icon">
                                <app-icon
                                    [icon]="'face'"
                                    [color]="'white'"
                                ></app-icon>
                            </span>
                            <span class="color__icon"> </span>
                            <div
                                class="color__item"
                                [ngStyle]="{
                                    background: character.colors.skinColor
                                }"
                            ></div>
                            <span class="color__icon">
                                <app-icon
                                    [icon]="'hair'"
                                    [color]="'white'"
                                ></app-icon>
                            </span>
                            <div
                                class="color__item"
                                [ngStyle]="{
                                    background: character.colors.hairColor
                                }"
                            ></div>
                        </div>
                    </div>
                </ng-container>
                <ng-container
                    *ngIf="
                        character.temperament?.melancholic ||
                        character.temperament?.sanguine ||
                        character.temperament?.flegmatic ||
                        character.temperament?.choleric
                    "
                >
                    <div class="info__temperament temperament">
                        <mat-divider></mat-divider>
                        <div
                            class="temperament__container"
                            *ngIf="character.temperament?.melancholic"
                        >
                            <span class="info__desc">
                                {{ 'CHARACTER_CARD.MELANCHOLIC' | translate }}
                            </span>
                            <div
                                appProgressBar
                                [percentValue]="
                                    character.temperament?.melancholic
                                "
                                temperamentType="melancholic"
                            ></div>
                        </div>
                        <div
                            class="temperament__container"
                            *ngIf="character.temperament?.sanguine"
                        >
                            <span class="info__desc">
                                {{ 'CHARACTER_CARD.SANGUINE' | translate }}
                            </span>
                            <div
                                appProgressBar
                                [percentValue]="character.temperament?.sanguine"
                                temperamentType="sanguine"
                            ></div>
                        </div>
                        <div
                            class="temperament__container"
                            *ngIf="character.temperament?.flegmatic"
                        >
                            <span class="info__desc">
                                {{ 'CHARACTER_CARD.FLEGMATIC' | translate }}
                            </span>
                            <div
                                appProgressBar
                                [percentValue]="
                                    character.temperament?.flegmatic
                                "
                                temperamentType="flegmatic"
                            ></div>
                        </div>
                        <div
                            class="temperament__container"
                            *ngIf="character.temperament?.choleric"
                        >
                            <span class="info__desc">
                                {{ 'CHARACTER_CARD.CHOLERIC' | translate }}
                            </span>
                            <div
                                appProgressBar
                                [percentValue]="character.temperament?.choleric"
                                temperamentType="choleric"
                            ></div>
                        </div>
                    </div>
                </ng-container>
            </mat-card>
        </mat-card>
    </div>

    <mat-card class="information">
        <div *ngIf="character.quote" class="information__quote quote">
            <blockquote class="quote__blockquote">
                {{ character.quote.quote }}
            </blockquote>
            <cite
                *ngIf="character.quote.context"
                class="quote__cite"
                [ngStyle]="{ color: themeColor1 }"
                >~ {{ character.quote.context }}</cite
            >
        </div>
        <div class="information__story">
            <ng-container *ngIf="character.story">
                <ng-container *ngFor="let story of character.story">
                    <div class="story">
                        <h2
                            class="story__title"
                            [ngStyle]="{ color: themeColor1 }"
                        >
                            {{ story.title }}
                        </h2>
                        <div class="story__story-block">
                            {{ story.story }}
                        </div>
                    </div>
                </ng-container>
            </ng-container>
            <div
                *ngIf="character.story.length === 0"
                class="no-story-container"
            >
                {{ 'CHARACTER_CARD.NO_STORY' | translate }}.
            </div>
        </div>

        <div
            class="information__segment"
            *ngIf="preferences && !!preferences.length"
        >
            <mat-divider></mat-divider>
            <h2 class="story__title" [ngStyle]="{ color: themeColor1 }">
                ü§ó {{ 'CHARACTER_CARD.PREFERENCES' | translate }}
            </h2>
            <app-preferences [preferences]="preferences" [bgColor]="bgColor1">
            </app-preferences>
        </div>

        <div
            class="information__segment"
            *ngIf="
                character.relationships && character.relationships.length > 0
            "
        >
            <mat-divider></mat-divider>

            <h2 class="story__title" [ngStyle]="{ color: themeColor1 }">
                {{ 'CHARACTER_CARD.FAMILY_RELATIONS' | translate }}
            </h2>

            <app-char-family-tree
                [charRelationships]="character.relationships"
            ></app-char-family-tree>
        </div>

        <div
            class="information__segment"
            *ngIf="character.measurements?.hasAnyValues"
        >
            <mat-divider></mat-divider>
            <h2 class="story__title" [ngStyle]="{ color: themeColor1 }">
                üìè {{ 'CHARACTER_CARD.WEIGHT_HEIGHT_TABLE' | translate }}
            </h2>

            <app-measurements
                [measurements]="character.measurements"
            ></app-measurements>
        </div>

        <div
            class="information__segment"
            *ngIf="character.starringIn && !!character.starringIn.length"
        >
            <mat-divider></mat-divider>
            <h2 class="story__title" [ngStyle]="{ color: themeColor1 }">
                üìö {{ 'CHARACTER_CARD.APPEARANCE' | translate }}
            </h2>
            <app-starring-in-info [starringIn]="character.starringIn">
            </app-starring-in-info>
        </div>
    </mat-card>
</section>
