<app-loader [visible]="!character && loading"></app-loader>

<section class="characters-card" *ngIf="character && !loading">
  <div class="card" [ngStyle]="{'border-color': character.colors.themeColor2
}">


    <div class="card__profile-pic profile-pic" [ngStyle]="{'background': bgColor1
  }"> <span class="card__type" [ngStyle]="{'background': bgColor2}">
        {{charType}}
      </span>
      <span class="card__name" [ngStyle]="{'background': bgColor2}">
        <app-icon *ngIf="character.gender" [icon]="character.gender | lowercase"
          [color]="character.gender === 'MALE' ? '#89cff0' : '#FFC0CB'" [size]="'0.7'">
        </app-icon>
        {{character.charName}} {{ character.charSurname}}
      </span>
      <ng-container *ngIf="character.imagesList.length > 0">
        <img *ngFor="let image of character.imagesList;index as i"
          [src]="'data:image/' + image?.extension + ';base64, ' + image.image | sanitizer"
          class="profile-pic__image profile-pic__image--inactive" [ngClass]="{
						'profile-pic__image--active': i === currentImageIndex
          }">
        <div>

          <button class="profile-pic__button" [ngStyle]="{'background': bgColor2}"
            *ngFor="let image of character.imagesList; index as i"
            (click)="setImage(i)">{{image.name | filenameModifier}}</button>
        </div>

      </ng-container>
      <div class="card__profile-pic--empty" *ngIf="character.imagesList.length === 0">
        Brak zdjęć
      </div>
    </div>

    <div class="card__info info" [ngStyle]="{'background': bgColor2}">
      <ng-container *ngIf="character.birthday">
        <span class="info__desc">Data urodzenia</span>
        <span class="info__data">{{character.birthday | date: 'dd/MM/yyyy'}}
        </span>
      </ng-container>

      <ng-container *ngIf="character.death">
        <span class="info__desc">
          Śmierć:
        </span>
        <span class="info__data info__data--death">
          {{character.death | date: 'dd/MM/yyyy'}}
          <br />
          <span *ngIf="character.deathReason">
            ({{character.deathReason}})
          </span>
        </span>
      </ng-container>
      <ng-container *ngIf="character.occupation">
        <span class="info__desc">Zawód</span>
        <span class="info__data">{{character.occupation}}</span>
      </ng-container>

      <ng-container *ngIf="character.colors">
        <div class="info__color color">
          <span class="info__desc">Paleta kolorów</span>
          <div class="color__container">
            <span class="color__icon">
              <app-icon [icon]="'clothing'" [color]="'white'"></app-icon>
            </span>
            <div class="color__item" [ngStyle]="{'background': character.colors.themeColor1}"></div>
            <div class="color__item" [ngStyle]="{'background': character.colors.themeColor2}"></div>
            <div class="color__item" [ngStyle]="{'background': character.colors.themeColor3}"></div>
          </div>
          <div class="color__container">
            <span class="color__icon">
              <app-icon [icon]="'eye'" [color]="'white'"></app-icon>
            </span>
            <div class="color__item color__item--eye"
              [ngStyle]="{'background-image': 'linear-gradient(to left,'+ character.colors.eyeColor1 + ', ' + character.colors.eyeColor2}">
            </div>
          </div>
          <div class="color__container">
            <span class="color__icon">
              <app-icon [icon]="'face'" [color]="'white'"></app-icon>
            </span>
            <span class="color__icon">
            </span>
            <div class="color__item" [ngStyle]="{'background': character.colors.skinColor}"></div>
            <span class="color__icon">
              <app-icon [icon]="'hair'" [color]="'white'"></app-icon>
            </span>
            <div class="color__item" [ngStyle]="{'background': character.colors.hairColor}"></div>
          </div>

        </div>
      </ng-container>
      <ng-container *ngIf="character.temperament">
        <div class="info__temperament temperament">
          <span class="info__desc">Temperament</span>
          <div class="temperament__container">
            <span class="info__desc">Melancholik</span>
            <div appProgressBar
              [percentValue]="character.temperament.melancholic ? character.temperament.melancholic : 0"
              temperamentType='melancholic'>
            </div>
          </div>
          <div class="temperament__container">
            <span class="info__desc">Sangwinik</span>
            <div appProgressBar [percentValue]="character.temperament.sanguine ? character.temperament.sanguine : 0"
              temperamentType='sanguine'>
            </div>
          </div>
          <div class="temperament__container">
            <span class="info__desc">Flegmatyk</span>
            <div appProgressBar [percentValue]="character.temperament.flegmatic ? character.temperament.flegmatic : 0"
              temperamentType='flegmatic'>
            </div>
          </div>
          <div class="temperament__container">
            <span class="info__desc">Choleryk</span>
            <div appProgressBar [percentValue]="character.temperament.choleric ? character.temperament.choleric : 0"
              temperamentType='choleric'>
            </div>
          </div>
        </div>

      </ng-container>


    </div>
  </div>
  <div class="information">
    <div *ngIf="character.quote" class="information__quote quote">
      <blockquote class="quote__blockquote">
        {{character.quote.quote}}
      </blockquote>
      <cite *ngIf="character.quote.context" class="quote__cite" [ngStyle]="{'color': themeColor1}">~
        {{character.quote.context}}</cite>
    </div>
    <div class="information__story ">
      <ng-container *ngIf="character.story">
        <ng-container *ngFor="let story of character.story">
          <div class="story">
            <h2 class="story__title" [ngStyle]="{'color': themeColor1}">{{story.title}}</h2>
            <div class="story__story-block">
              {{story.story}}
            </div>
          </div>
        </ng-container>
      </ng-container>
      <ng-container *ngIf="character.story.length === 0">
        Brak znanej historii.
      </ng-container>
    </div>
    <div *ngIf="character.relationships && character.relationships.length > 0">
      <h2 class="story__title" [ngStyle]="{'color': themeColor1}">Relacje rodzinne</h2>
      <ul class="relationships">
        <ng-container *ngFor="let relationship of character.relationships">
          <li class="relationship" [routerLink]="['../', relationship.relatedCharacter.id]"
            [title]="relationship.relatedCharacter.charName + ' ' + relationship.relatedCharacter.charSurname">
            <div class="relation-profile-pic">
              <img class="relation-profile-pic__image"
                [src]="'data:image/' + relationship.relatedCharacter?.profilePic?.extension + ';base64, ' + relationship.relatedCharacter?.profilePic?.image | sanitizer">
            </div>
            <span>{{relationship.relatedCharacter.charName}}
              {{relationship.relatedCharacter.charSurname}}</span>
            <span [ngStyle]="{'color': themeColor1}">
              {{relationship.relationName}}
            </span>
          </li>
        </ng-container>

      </ul>

    </div>
    <div>
      <h2 class="story__title" [ngStyle]="{'color': themeColor1}">Tabela wzrostu i wagi</h2>
      <table *ngIf="character.measurements" class="information__measurements measurements global-table">
        <tr class="global-table__row">
          <th class="global-table__header"></th>
          <th class="global-table__header">Niemowlę <br />(0-3)</th>
          <th class="global-table__header">Dziecko <br />(4-11)</th>
          <th class="global-table__header">Nastolatek <br />(12-19)</th>
          <th class="global-table__header">Dorosły <br />(20+)</th>
        </tr>
        <tr class="global-table__row">
          <th class="global-table__header">Wzrost</th>
          <td class="global-table__cell">{{character.measurements.babyHeight | nulled}} cm</td>
          <td class="global-table__cell">{{character.measurements.childHeight | nulled}} cm</td>
          <td class="global-table__cell">{{character.measurements.teenHeight | nulled}} cm</td>
          <td class="global-table__cell">{{character.measurements.adultHeight | nulled}} cm</td>
        </tr>
        <tr class="global-table__row">
          <th class="global-table__header">Waga</th>
          <td class="global-table__cell">{{character.measurements.babyWeight | nulled}} kg</td>
          <td class="global-table__cell">{{character.measurements.childWeight | nulled}} kg</td>
          <td class="global-table__cell">{{character.measurements.teenWeight | nulled}} kg</td>
          <td class="global-table__cell">{{character.measurements.adultWeight | nulled}} kg</td>
        </tr>
      </table>
    </div>
  </div>
</section>
